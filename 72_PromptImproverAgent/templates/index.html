<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptImproverAgent ‚Äì Day 72</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = { theme: { fontFamily: { 'sans': ['Montserrat','ui-sans-serif','system-ui'] }, extend: { colors: { accent:'#14b8a6', dark:'#23232b', gold:'#FFD700' }, boxShadow: { 'glass': '0 8px 32px 0 rgba(20,184,166,.10), 0 1.5px 4px 0 #14b8a655' }, animation: { 'fade-in':'fadeIn .5s ease-in', 'slide-up':'slideUp .5s ease-out', 'pop':'pop .4s ease-out' }, keyframes: { fadeIn:{'0%':{opacity:0},'100%':{opacity:1}}, slideUp:{'0%':{transform:'translateY(24px)',opacity:0},'100%':{transform:'translateY(0)',opacity:1}}, pop:{'0%':{transform:'scale(.98)'},'100%':{transform:'scale(1)'}} } } } }
    </script>
    <style>
      body{background:linear-gradient(120deg,#e0f7fa 0%,#f0fdfa 100%);font-family:'Montserrat',ui-sans-serif,system-ui,sans-serif}
      .glass{background:rgba(255,255,255,.82);backdrop-filter:blur(12px);border:1.5px solid rgba(20,184,166,.24);box-shadow:0 8px 32px 0 #14b8a640,0 1.5px 4px 0 #FDBA7488}
      .copy-flash{box-shadow:0 0 0 2px rgba(20,184,166,.3) inset;transition:box-shadow .6s ease}
      .copy-flash.done{box-shadow:0 0 0 0 rgba(20,184,166,0) inset}
    </style>
</head>
<body class="min-h-screen flex flex-col text-dark">
    <nav class="bg-accent bg-opacity-90 py-2 shadow text-white font-bold sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center px-4">
            <div class="flex items-center gap-2"><span class="text-xl">‚úçÔ∏è</span> PromptImproverAgent</div>
            <a href="https://github.com/muhammadsami987123/100DaysOfAI-Agents" target="_blank" class="hover:underline hover:text-gold transition">#100DaysOfAI-Agents</a>
        </div>
    </nav>

    <main class="flex-1 container mx-auto px-4 py-10">
        <section class="max-w-2xl mx-auto glass shadow-glass p-8 rounded-3xl animate-slide-up">
            <header class="mb-8 text-center">
                <h1 class="text-4xl md:text-5xl font-extrabold text-accent mb-3 tracking-tight drop-shadow-lg"><span class="inline-block align-middle">‚úçÔ∏è</span> PromptImproverAgent</h1>
                <p class="text-lg text-gray-700 font-medium">Transform unclear prompts into clear, structured instructions for LLMs. Try a rough prompt below!</p>
            </header>

            <form id="promptForm" class="space-y-5" autocomplete="off">
                <div>
                    <label for="rawPrompt" class="block text-accent font-bold mb-2">Your Unclear Prompt</label>
                    <textarea id="rawPrompt" name="raw_prompt" required rows="4" placeholder="E.g., 'explain quantum computers simple' or 'write email to boss sick'" class="w-full px-5 py-3 rounded-xl border-2 border-accent/10 focus:border-accent/70 transition glass text-base font-semibold text-dark placeholder:italic"></textarea>
                </div>
                <div>
                    <label for="tone" class="block text-accent font-bold mb-2">Target Tone / Style <span class="font-normal text-gray-400">(optional)</span></label>
                    <select id="tone" name="tone" class="w-full px-4 py-2 rounded-lg border-2 border-accent/10 focus:border-accent transition glass font-semibold text-dark">
                        <option value="">Let the agent choose</option>
                        <option value="Formal">Formal</option>
                        <option value="Creative">Creative</option>
                        <option value="Concise">Concise</option>
                        <option value="Friendly">Friendly</option>
                        <option value="Detailed">Detailed</option>
                    </select>
                </div>
                <button type="submit" class="w-full bg-accent hover:bg-accent/80 text-white font-bold text-lg py-3 rounded-xl shadow transition active:scale-95 flex items-center justify-center gap-2"><span id="btnText">Improve Prompt</span> <svg id="btnSpinner" class="hidden animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></button>
            </form>

            <section id="resultArea" class="hidden animate-fade-in mt-10">
                <div class="flex items-center justify-between gap-3 mb-2">
                    <h2 class="text-2xl font-bold text-accent">üîé Improved Prompt</h2>
                    <button id="copyImproved" class="text-sm px-3 py-1 rounded bg-accent text-white hover:bg-accent/80" title="Copy improved prompt">Copy</button>
                </div>
                <pre id="improvedPrompt" class="glass p-5 rounded-lg text-base bg-accent/5 border border-accent/10 font-semibold mb-6 text-dark whitespace-pre-wrap break-words leading-relaxed copy-flash"></pre>

                <div class="flex items-center justify-between gap-3 mb-2">
                    <h3 class="text-lg font-bold text-accent">Alternative Variations</h3>
                    <button id="copyVariations" class="text-sm px-3 py-1 rounded bg-accent text-white hover:bg-accent/80" title="Copy all variations">Copy All</button>
                </div>
                <ol id="variations" class="list-inside list-decimal space-y-2 mb-6 pl-6">
                </ol>

                <div id="whyBlock" class="hidden">
                    <h4 class="font-bold text-accent mb-2">Why improved this way</h4>
                    <div id="explanation" class="glass p-4 rounded text-sm text-dark/80 whitespace-pre-wrap break-words leading-relaxed"></div>
                </div>
            </section>
            <div id="errorMessage" class="hidden text-red-500 text-center font-bold mt-8"></div>
        </section>
    </main>

    <footer class="bg-accent bg-opacity-90 py-4 text-white text-center font-semibold mt-auto rounded-t-3xl shadow-inner">
      &copy; 2025 PromptImproverAgent | Part of the #100DaysOfAI-Agents
    </footer>
    
    <script>
      const form = document.getElementById('promptForm');
      const resultArea = document.getElementById('resultArea');
      const improvedPrompt = document.getElementById('improvedPrompt');
      const variationsList = document.getElementById('variations');
      const explanation = document.getElementById('explanation');
      const whyBlock = document.getElementById('whyBlock');
      const errorMessage = document.getElementById('errorMessage');
      const btnText = document.getElementById('btnText');
      const btnSpinner = document.getElementById('btnSpinner');
      const copyImproved = document.getElementById('copyImproved');
      const copyVariations = document.getElementById('copyVariations');

      function flashCopy(el){
        el.classList.remove('done');
        el.classList.add('copy-flash');
        setTimeout(()=>{ el.classList.add('done'); }, 150);
        setTimeout(()=>{ el.classList.remove('copy-flash','done'); }, 700);
      }
      async function copyWithFeedback(getText, btn){
        try{
          await navigator.clipboard.writeText(getText());
          const prev = btn.textContent;
          btn.textContent = 'Copied!';
          btn.classList.add('animate-pop');
          setTimeout(()=>{ btn.textContent = prev; btn.classList.remove('animate-pop'); }, 900);
        }catch(e){ /* ignore */ }
      }

      copyImproved.addEventListener('click', async () => {
        flashCopy(improvedPrompt);
        copyWithFeedback(()=> improvedPrompt.textContent || '', copyImproved);
      });
      copyVariations.addEventListener('click', async () => {
        const text = [...variationsList.querySelectorAll('li')].map(li => li.textContent).join('\n');
        copyWithFeedback(()=> text, copyVariations);
      });

      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        btnText.textContent = 'Improving...';
        btnSpinner.classList.remove('hidden');
        resultArea.classList.add('hidden');
        errorMessage.classList.add('hidden');
        const raw_prompt = document.getElementById('rawPrompt').value.trim();
        const tone = document.getElementById('tone').value;
        try {
          const response = await fetch('/improve', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ raw_prompt, tone })
          });
          btnText.textContent = 'Improve Prompt';
          btnSpinner.classList.add('hidden');
          if (!response.ok) { throw new Error('Request failed'); }
          const data = await response.json();
          improvedPrompt.textContent = data.improved_prompt || '';
          variationsList.innerHTML = '';
          (data.variations || []).forEach((v, idx) => {
            const li = document.createElement('li');
            li.className = 'whitespace-pre-wrap break-words leading-relaxed';
            li.textContent = typeof v === 'string' ? v : JSON.stringify(v);
            variationsList.appendChild(li);
          });
          if (data.explanation && String(data.explanation).trim().length > 0) {
            explanation.textContent = data.explanation;
            whyBlock.classList.remove('hidden');
          } else {
            explanation.textContent = '';
            whyBlock.classList.add('hidden');
          }
          resultArea.classList.remove('hidden');
          resultArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } catch (e) {
          errorMessage.classList.remove('hidden');
          errorMessage.textContent = 'Error: ' + (e.message || 'Could not process that prompt.');
        } finally {
          btnText.textContent = 'Improve Prompt';
          btnSpinner.classList.add('hidden');
        }
      });
    </script>
</body>
</html>
